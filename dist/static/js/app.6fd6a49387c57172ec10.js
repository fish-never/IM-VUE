webpackJsonp([1],{"2r5n":function(t,e){},"34QF":function(t,e,a){"use strict";var s=a("//Fk"),i=a.n(s),n=a("mw3O"),o=a.n(n),r=a("cKc3");e.a={getIfList:function(t){return r.a.get("config/bot/index?"+o.a.stringify(t)).then(function(t){return i.a.resolve(t.data)})},update:function(t){return r.a.post("config/bot/update",t,!0).then(function(t){return i.a.resolve(t.data)})},create:function(t){return r.a.post("config/bot/create",t,!0).then(function(t){return i.a.resolve(t.data)})},clickDelete:function(t){return r.a.post("config/bot/delete",t,!0).then(function(t){return i.a.resolve(t.data)})},getPro:function(t){return r.a.get("config/bot/getProduct").then(function(t){return i.a.resolve(t.data)})},getWaitingList:function(t){return r.a.post("custim/cust/waitHandle",t,!0).then(function(t){return i.a.resolve(t.data)})},getOverDueList:function(t){return r.a.post("custim/cust/expiredList",t,!0).then(function(t){return i.a.resolve(t.data)})},accessFun:function(t){return r.a.get("custim/cust/accessStudent?"+o.a.stringify(t)).then(function(t){return i.a.resolve(t.data)})},getCustList:function(t){return r.a.get("custim/cust/customerOnlineList?"+o.a.stringify(t)).then(function(t){return i.a.resolve(t.data)})},transferStu:function(t){return r.a.post("custim/cust/transferStudent",t,!0).then(function(t){return i.a.resolve(t.data)})},saveAccount:function(t){return r.a.post("custim/cust/addCustomer",t,!0).then(function(t){return i.a.resolve(t.data)})},updateUser:function(t){return r.a.post("custim/cust/updateCustomer",t,!0).then(function(t){return i.a.resolve(t.data)})},getCustomerList:function(t){return r.a.get("custim/cust/getCustomer?"+o.a.stringify(t)).then(function(t){return i.a.resolve(t.data)})},disableAccount:function(t){return r.a.post("custim/cust/disableCustomer",t,!0).then(function(t){return i.a.resolve(t.data)})},enableAccount:function(t){return r.a.post("custim/cust/enableCustomer",t,!0).then(function(t){return i.a.resolve(t.data)})},deleteAccount:function(t){return r.a.post("custim/cust/deleteCustomer",t,!0).then(function(t){return i.a.resolve(t.data)})},logout:function(t){return r.a.post("custim/login/logout",!0).then(function(t){return i.a.resolve(t.data)})}}},"4XJR":function(t,e){},"7UQV":function(t,e){},"80mf":function(t,e){},DD6N:function(t,e){},HzwQ:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("7+uW"),i={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var n=a("VU/8")({name:"App"},i,!1,function(t){a("dhmY")},null,null).exports,o=a("NYxO"),r=a("/ocq"),l=a("34QF"),c=a("7t+N"),d=a.n(c);window.$=d.a,window.onbeforeunload=function(){alert("===onbeforeunload==="),event.clientX>document.body.clientWidth&&event.clientY<0||event.altKey?alert("你关闭了浏览器"):alert("你正在刷新页面")};var u={name:"index",data:function(){return{tabNum:0,stateChangeNum:!1,stateNum:0,num:0,total:7,nickname:"",totalUnreadNum:0,root:"",disable:"",origin_id:""}},computed:{count:function(){return this.$store.state.count}},created:function(){var t=this,e=localStorage.getItem("totalUnreadNum");isNaN(e)&&(this.totalUnreadNum=0),document.querySelector("body").addEventListener("click",function(e){"state_box"===e.target.className||"state_set"===e.target.className||(t.stateChangeNum=!1)},!1),this.root=localStorage.getItem("root"),this.disable=localStorage.getItem("disable"),this.nickname=localStorage.getItem("nickname"),this.stateNum=parseInt(localStorage.getItem("stateNum")),this.origin_id=localStorage.getItem("origin_id"),this.$route.path.indexOf("Setting")>-1&&(this.tabNum=2)},watch:{},mounted:function(){console.log("89898"),this.getWaitingNum()},methods:{quit:function(){var t=this;this.$confirm("确定退出？","消息",{distinguishCancelAndClose:!0,confirmButtonText:"确定",cancelButtonText:"取消"}).then(function(){localStorage.setItem("stateNum",0),t.logout()}).catch(function(t){})},gotoCon:function(){this.tabNum=0},numShow:function(t){this.num=t},changetabNum:function(t){this.tabNum=t},Showjjf:function(t){this.stateNum=t,localStorage.setItem("stateNum",t)},msgTotal:function(t){this.totalUnreadNum=t},tabChoose:function(t){this.tabNum=t,0===t?this.$router.push("/index"):1===t?this.$router.push("/index"):2===t&&this.$router.push("Setting")},showToggle:function(){this.stateChangeNum=!this.stateChangeNum},changeState:function(t){this.stateNum=t,localStorage.setItem("stateNum",t),this.stateChangeNum=!1},logout:function(){var t=this;l.a.logout().then(function(e){0==e.code&&t.$router.push("/")})},getWaitingNum:function(){var t=this,e={origin_id:this.origin_id,page:this.page,pageSize:this.pageSize};l.a.getWaitingList(e).then(function(e){if(0==e.code){var a=e.data;t.num=a.total}})}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"main_content"},[a("div",{staticClass:"main_header"},[a("div",{staticClass:"tab"},[a("div",{class:0==t.tabNum?"tab_item float_l tab_choose":"tab_item float_l",on:{click:function(e){t.tabChoose(0)}}},[t._v("\n          会话\n           "),t.totalUnreadNum>0?a("span",[t._v("("+t._s(t.totalUnreadNum)+")")]):t._e()]),t._v(" "),a("div",{class:1==t.tabNum?"tab_item float_l tab_choose":"tab_item float_l",on:{click:function(e){t.tabChoose(1)}}},[t._v("\n          待接入"),t.num>0?a("span",[t._v("("+t._s(t.num)+")")]):t._e()]),t._v(" "),1==t.root&&0==t.disable?a("div",{class:2==t.tabNum?"tab_item float_l tab_choose":"tab_item float_l",on:{click:function(e){t.tabChoose(2)}}},[a("i",{staticClass:"el-icon-setting fontsize20"})]):t._e()]),t._v(" "),a("div",{staticClass:"state",on:{click:t.showToggle}},[a("span",{directives:[{name:"show",rawName:"v-show",value:1===t.stateNum,expression:"stateNum===1"}],staticClass:"state_icon online"}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:0===t.stateNum,expression:"stateNum===0"}],staticClass:"state_icon leave"}),t._v(" "),a("span",{staticClass:"state_set"},[t._v(t._s(t.nickname))])]),t._v(" "),a("div",{staticClass:"quite",on:{click:function(e){t.quit()}}},[a("span",[t._v("退出")])]),t._v(" "),a("div",{directives:[{name:"show",rawName:"v-show",value:t.stateChangeNum,expression:"stateChangeNum"}],staticClass:"state_box"},[a("ul",[a("li",{staticClass:"state_li",on:{click:function(e){t.changeState(1)}}},[a("span",{staticClass:"state_icon online"}),t._v(" "),a("span",[t._v("在线")])]),t._v(" "),a("li",{staticClass:"state_li",on:{click:function(e){t.changeState(0)}}},[a("span",{staticClass:"state_icon leave"}),t._v(" "),a("span",[t._v("离开")])])])])]),t._v(" "),a("div",{staticClass:"main_body"},[a("router-view",{attrs:{tabNum:t.tabNum,onlineStatua:t.stateNum},on:{gotoCon:t.gotoCon,shownum:t.numShow,tabNum:t.changetabNum,msgTotal:t.msgTotal,showjj:t.Showjjf}})],1)])},staticRenderFns:[]};var g=a("VU/8")(u,m,!1,function(t){a("80mf"),a("OiEn")},"data-v-4a535b38",null).exports,p=a("mvHQ"),_=a.n(p),f=a("//Fk"),h=a.n(f),v=a("cKc3"),b=function(t,e){return v.a.setToken(null),v.a.post("custim/login/index",{username:t,password:e},!0).then(function(t){return console.log(t),0==t.data.code&&(localStorage.setItem("Token",t.data.data.token),localStorage.setItem("nickname",t.data.data.nickname),localStorage.setItem("disable",t.data.data.disable),localStorage.setItem("avatar",t.data.data.avatar),localStorage.setItem("cust_id",t.data.data.id),localStorage.setItem("root",t.data.data.root),localStorage.setItem("origin_id",t.data.data.product_list[0].origin_id),localStorage.setItem("stateNum",0),localStorage.setItem("product_list",_()(t.data.data.product_list)),v.a.setToken(t.data.data.token)),h.a.resolve(t.data)})},C={name:"App",data:function(){return{username:"alin",password:"123456"}},methods:{open:function(t){this.$alert(t,"信息",{confirmButtonText:"确定"})},login:function(){var t=this;""!=this.username?""!=this.password?b(this.username,this.password).then(function(e){e.code,t.$router.push({path:"index"})}).catch(function(e){22==_()(e).code&&t.open("当前模式为隐秘模式,需切换模式才能使用")}):this.open("请输入密码"):this.open("请输入邮箱")}}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"demo-ruleForm login"},[a("div",{staticClass:"login-wrap"},[a("p",{staticClass:"login-top"},[t._v("登录")]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"login-text email-icon"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.username,expression:"username"}],staticClass:"login-input",attrs:{type:"email",placeholder:"邮箱"},domProps:{value:t.username},on:{input:function(e){e.target.composing||(t.username=e.target.value)}}})]),t._v(" "),a("div",{staticClass:"item"},[a("span",{staticClass:"login-text ps-icon"}),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.password,expression:"password"}],staticClass:"login-input",attrs:{type:"password",placeholder:"密码"},domProps:{value:t.password},on:{keyup:function(e){return"button"in e||!t._k(e.keyCode,"enter",13,e.key,"Enter")?t.login(e):null},input:function(e){e.target.composing||(t.password=e.target.value)}}})]),t._v(" "),a("button",{staticClass:"btn",on:{click:t.login}},[t._v("登录")])])])},staticRenderFns:[]};var y=a("VU/8")(C,w,!1,function(t){a("d8ns")},"data-v-5d28b0fc",null).exports,L=a("mw3O"),x=a.n(L),k=function(t){return console.log(t),v.a.get("/custim/cust/studentList?"+x.a.stringify(t)).then(function(t){return h.a.resolve(t.data)})},S=function(t){return v.a.get("custim/cust/online?"+x.a.stringify(t)).then(function(t){return h.a.resolve(t.data)})},N=function(t){return v.a.get("custim/cust/chatHistory?"+x.a.stringify(t)).then(function(t){return h.a.resolve(t.data)})},I=function(t){return v.a.get("custim/cust/offline?"+x.a.stringify(t)).then(function(t){return h.a.resolve(t.data)})},F=["/::)","/::~","/::B","/::|","/:8-)","/::<","/::$","/::X","/::Z","/::'(","/::-|","/::@","/::P","/::D","/::O","/::(","/::+","/:–b","/::Q","/::T","/:,@P","/:,@-D","/::d","/:,@o","/::g","/:|-)","/::!","/::L","/::>","/::,@","/:,@f","/::-S","/:?","/:,@x","/:,@@","/::8","/:,@!","/:!!!","/:xx","/:bye","/:wipe","/:dig","/:handclap","/:&-(","/:B-)","/:<@","/:@>","/::-O","/:>-|","/:P-(","/::'|","/:X-)","/::*","/:@x","/:8*","/:pd","/:<W>","/:beer","/:basketb","/:oo","/:coffee","/:eat","/:pig","/:rose","/:fade","/:showlove","/:heart","/:break","/:cake","/:li","/:bome","/:kn","/:footb","/:ladybug","/:shit","/:moon","/:sun","/:gift","/:hug","/:strong","/:weak","/:share","/:v","/:@)","/:jj","/:@@","/:bad","/:lvu","/:no","/:ok","/:love","/:<L>","/:jump","/:shake","/:<O>","/:circle","/:kotow","/:turn","/:skip","[挥手]","/:#-0","[街舞]","/:kiss","/:<&","/:&>"];function T(t){return'<img  src="https://res.wx.qq.com/mpkf/zh_CN/images/icon/emotion/'+t+'.gif" data-emoji="'+t+'"/>'}var $={list:F,emojiIndexToImg:T,emojiToImg:function(t){for(var e=t,a=0;a<F.length;a++){var s=F[a];if(e)for(;-1!=e.indexOf(s);)e=e.replace(s,T(a))}return e},imgToEomoji:function(t){return t.replace(/<img .*? data-emoji="(.*?)".*?>/g,function(t,e){return F[e]})}},A={name:"Emoji",data:function(){return{emojis:$.list}},created:function(){},mounted:function(){},methods:{addEmoji:function(t){this.$emit("onEmojiClick",t)}}},j={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{staticClass:"page_emotion box_swipe",attrs:{id:"page_emotion"}},[a("div",{staticClass:"qq_body",staticStyle:{display:"block"}},t._l(t.emojis,function(e,s){return a("a",{key:s,staticClass:"face_wrap qq_wrap",attrs:{href:"#"}},[a("img",{staticClass:"emoji-icon",attrs:{src:"https://res.wx.qq.com/mpkf/zh_CN/images/icon/emotion/"+s+".gif"},on:{click:function(e){t.addEmoji(s)}}})])}))])])},staticRenderFns:[]};var M=a("VU/8")(A,j,!1,function(t){a("7UQV")},"data-v-3fc74712",null).exports;window.$=d.a;var U,E=localStorage.getItem("origin_id"),P={clientLists:[],lists:[],msgsLists:[],nickname:"",avatar:"",open_id:"",userIcon:a("UNrT"),userName:"尚德成长+",editContent:"",showHistory:!1,emojiShowFlag:!1,totalUnreadNum:0,curIndex:0,options:[{value:"选项1",label:"尚德成长+"},{value:"选项2",label:"菠萝英语"}],value8:"",waitingList:[],overdueList:[],proList:[],expire:[],page:1,pageSize:5,total:0,total1:"",pageShow:!1,cust_id:4,origin_id:E,origin_id01:E,origin_id02:E,tipsShow:!0,closeFlag:!1,custList:[],custShow:0,custChose:"no",new_cust_id:"",shownum:0,nowtime:(new Date).getTime(),focusState:!1,ws:"",onlineFlag:!1,radio:!1,is_all:1,accessStatus:0,beyond:0,lsClientLists:[],root:0,proIcon:"",overdue:"",pro_client_list:[],prolsClientLists:[],showList:!0},z={name:"index",props:["onlineStatua","tabNum"],data:function(){return P},components:{Emoji:M},directives:{focus:{update:function(t,e){e.value&&t.focus()}}},created:function(){var t=this;document.querySelector("body").addEventListener("click",function(e){"toggler-btn"===e.target.id||"page_emotion"===e.target.id||"emoji-icon"===e.target.className?(t.emojiShowFlag=!0,document.getElementById("editor").focus()):t.emojiShowFlag=!1},!1),this.custShow=0,this.cust_id=localStorage.getItem("cust_id"),this.userName=localStorage.getItem("nickname"),this.proList=JSON.parse(localStorage.getItem("product_list")),this.root=localStorage.getItem("root");var e=parseInt(localStorage.getItem("totalUnreadNum"));isNaN(e)?this.totalUnreadNum=0:(this.totalUnreadNum=e,this.$emit("msgTotal",this.totalUnreadNum)),console.log(this.totalUnreadNum),1==localStorage.getItem("stateNum")&&(this.onlineFlag=!0,this.online())},beforeRouteEnter:function(t,e,a){a(function(t){t.msgsLists=[],t.nickname="",t.onlineFlag=!1,t.overdue="",t.showHistory=!1})},watch:{accessStatus:{handler:function(){this.accessStatus>0&&this.$notify({title:"消息提示",message:"你有一个新用户转入，请注意查看会话列表",type:"success",duration:0})},deep:!0},beyond:{handler:function(){this.$message.error("连续发送消息超过5次")},deep:!0},onlineStatua:function(t){console.log(t),1==t?(this.onlineFlag=!0,this.online()):(this.onlineFlag=!1,this.offline(),R())},totalUnreadNum:function(){this.$emit("msgTotal",this.totalUnreadNum)},tabNum:function(){0===this.tabNum?this.students():1===this.tabNum&&this.getWaitingList()},waitingList:function(){this.$set(P,"waitingList",this.waitingList)},total1:function(){this.total=this.total1,this.$emit("shownum",parseInt(this.total1))},closeFlag:function(){},msgsLists:{handler:function(){var t=this;setTimeout(function(){t.add()},500)},deep:!0},clientLists:{handler:function(){localStorage.setItem("clientLists",_()(this.pro_client_list)),this.prolsClientLists=JSON.parse(localStorage.getItem("clientLists"))},deep:!0}},mounted:function(){localStorage.getItem("clientLists").indexOf("proId")>-1&&(this.pro_client_list=JSON.parse(localStorage.getItem("clientLists"))),this.pro_client_list||(this.pro_client_list=[]),this.students(),this.getPro()},methods:{showLeftList:function(){this.showList?this.showList=!1:this.showList=!0},searchCust:function(){this.getCustList()},handleCurrentChange:function(t){this.page=parseInt(t),0==this.curIndex?this.getWaitingList():1==this.curIndex&&this.getOverDueList()},messageOpen:function(t){this.$message({message:t,type:"success"})},focusPre:function(){this.tipsShow=!1},showTip:function(){this.tipsShow=!0},offline:function(){var t=this,e={origin_id:this.origin_id,cust_id:this.cust_id};I(e).then(function(e){0==e.code?(R(),t.onlineFlag=!1,t.open("您已下线!")):t.open("下线失败,请刷新重试!")})},online:function(){var t=this,e=this,a={origin_id:this.origin_id,cust_id:this.cust_id,root:this.root};S(a).then(function(a){0==a.code?(t.ws=function t(e){console.log(e);U=new WebSocket(e);U.onmessage=D;U.onclose=function(){P.closeFlag=!0,P.onlineFlag&&(console.log("连接已关闭..."),setTimeout(function(){t(e)},3e4))}}(a.data+"?cust_id="+t.cust_id+"&origin_id="+t.origin_id+"&root="+t.root),t.onlineFlag=!0,1==e.tabNum&&e.getWaitingList()):(t.onlineFlag=!1,t.$emit("showjj",0),t.open(a.msg))}).catch(function(e){t.onlineFlag=!1,t.$emit("showjj",0)})},getHistory:function(){var t=this,e={open_id:this.open_id};N(e).then(function(e){0==e.code?(console.log(e),t.msgsLists=e.data.reverse(),t.msgsLists.forEach(function(t){t.msg=$.emojiToImg(t.msg)})):t.open("获取数据失败,请刷新重试!")})},getEmojiIdx:function(t){var e=$.emojiIndexToImg(t);this.editContent=this.$refs.editor.innerHTML+e},changeRadio:function(){!0===this.radio?this.is_all=0:this.is_all=1,this.students()},students:function(){var t=this,e=this;e.msgsLists=[],e.nickname="",e.onlineFlag=!1,e.overdue="",e.showHistory=!1;var a={origin_id:this.origin_id01,cust_id:this.cust_id,page:1,pageSize:9999,is_all:this.is_all};k(a).then(function(a){0==a.code?(a.data.list.sort(function(t,e){return t.status-e.status}),a.data.list.forEach(function(t){t.checked=!1,t.showNum=!0,t.num=0,t.inputMsg=""}),e.clientLists=a.data.list,e.pro_client_list.length<=0?(e.pro_client_list.push({proId:e.origin_id01,clientLists:e.clientLists}),localStorage.setItem("clientLists",_()(e.pro_client_list))):_()(e.pro_client_list).indexOf(e.origin_id01)>-1?d.a.each(e.pro_client_list,function(t,a){if(a.proId==e.origin_id01){e.prolsClientLists=JSON.parse(localStorage.getItem("clientLists")),e.lsClientLists=e.prolsClientLists[t].clientLists;for(var s=0;s<e.clientLists.length;s++)for(var i=0;i<e.lsClientLists.length;i++)if(e.lsClientLists[i].open_id==e.clientLists[s].open_id){e.clientLists[s].num=e.lsClientLists[i].num;break}e.pro_client_list[t].clientLists=e.clientLists,localStorage.setItem("clientLists",_()(e.pro_client_list))}}):(e.pro_client_list.push({proId:e.origin_id01,clientLists:e.clientLists}),localStorage.setItem("clientLists",_()(e.pro_client_list))),e.clientLists.forEach(function(a){a.latest_msg=$.emojiToImg(a.latest_msg);for(var s=0;s<t.proList.length;s++)if(a.origin_id==t.proList[s].origin_id){a.icon=e.proList[s].icon;break}})):t.open("获取数据失败,请刷新重试")})},firstClient:function(){console.log("first"),this.students(),this.clientLists.forEach(function(t){t.checked=!1}),console.log(this.clientLists,"first"),this.clientLists[0].checked=!0,this.open_id=this.clientLists[0].open_id,this.getHistory(),this.showHistory=!0},toggleEmoji:function(t){this.isMenuActive=!this.isMenuActive,this.emojiShowFlag=!0},getPro:function(){var t=this;l.a.getPro().then(function(e){0==e.code&&(console.log(e.data),t.proList=e.data)})},accessFun:function(t){var e=this,a=this;if(!0===a.onlineFlag){t.state=0;var s={open_id:t.open_id};l.a.accessFun(s).then(function(s){console.log(s),0==s.code?(a.getWaitingList(),a.$emit("shownum",a.total-1),a.$emit("tabNum",0),a.$emit("gotoCon")):(t.state=1,e.$message({message:s.msg}),a.getWaitingList())}).then(function(t){a.students()})}else this.open("离线状态无法接入用户，请先上线。")},getWaitingList:function(){var t=this,e={origin_id:this.origin_id02,page:parseInt(this.page),pageSize:this.pageSize};l.a.getWaitingList(e).then(function(e){if(0==e.code){var a=e.data;t.total=parseInt(a.total),t.$emit("shownum",parseInt(a.total)),t.page=parseInt(a.page),t.total>5&&(t.pageShow=!0),a.list.forEach(function(e){e.state=1;var a=new Date(e.updated_at).getTime()+1728e5,s=Math.floor((a-t.nowtime)/1e3/60/60);s<1?(s=Math.floor((a-t.nowtime)/1e3/60),e.overdue=s<1?"即将":s+"分钟后"):e.overdue=s+"小时后",e.latest_msg.msg=$.emojiToImg(e.latest_msg.msg);for(var i=0;i<t.proList.length;i++)if(e.origin_id==t.proList[i].origin_id){e.icon=t.proList[i].icon;break}}),t.waitingList=a.list}})},getOverDueList:function(){var t=this,e={origin_id:this.origin_id02,page:parseInt(this.page),pageSize:this.pageSize};l.a.getOverDueList(e).then(function(e){if(0==e.code){var a=e.data;t.total=parseInt(a.total),t.page=parseInt(a.page),t.total>5&&(t.pageShow=!0),a.list.forEach(function(t){t.state=1,t.latest_msg.msg=$.emojiToImg(t.latest_msg.msg)}),t.overdueList=a.list}})},updata:function(){0==this.tabNum?this.students():1==this.tabNum&&(this.page=1,this.pageShow=!1,0==this.curIndex?this.getWaitingList():1==this.curIndex&&this.getOverDueList())},changeTab:function(t){var e=t.currentTarget.dataset.index;this.curIndex=e,this.page=1,this.pageShow=!1,0==e?this.getWaitingList():1==e&&this.getOverDueList()},changeCust:function(){this.custShow=1,this.getCustList()},chooseCust:function(t,e){this.custChose=parseInt(t),this.new_cust_id=e.id},getCustList:function(t){var e=this,a={origin_id:e.origin_id};l.a.getCustList(a).then(function(a){if(0==a.code)if("success"===a.msg){var s=a.data;s.forEach(function(t,a){e.cust_id===t.id&&s.splice(a,1)}),e.custList=a.data}else t.state=1})},changeCustBtn:function(){var t=this,e=this;if("no"!=this.custChose){var a={cust_id:parseInt(e.cust_id),new_cust_id:parseInt(e.new_cust_id),open_id:e.open_id};l.a.transferStu(a).then(function(a){0==a.code?"success"===a.msg&&(t.$message({message:"转接客服成功",type:"success"}),e.custShow=0,e.custChose="no",e.clientLists.forEach(function(t,a){e.open_id===t.open_id&&(e.clientLists.splice(a,1),e.showHistory=!1)})):t.open(a.msg)})}else this.$confirm("请先选中一位客服","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"})},delChangeCustBtn:function(){this.custShow=0},add:function(){var t=document.getElementById("wrap");t.scrollTop=t.scrollHeight},open:function(t){this.$alert(t,"信息",{confirmButtonText:"确定"})},currUser:function(t){this.showHistory=!0;if(this.clientLists.forEach(function(t){t.checked=!1,t.showNum=!0}),t.checked=!0,t.showNum=!1,this.totalUnreadNum=this.totalUnreadNum-t.num,localStorage.setItem("totalUnreadNum",this.totalUnreadNum),t.num=0,this.overdue=t.status,this.nickname=t.nickname,this.avatar=t.avatar,this.open_id=t.open_id,this.origin_id=t.origin_id,this.msgsLists=[],localStorage.setItem("clientLists",this.pro_client_list),this.onlineFlag){var e={event:"chat_history",data:{cust_id:this.cust_id,open_id:this.open_id,origin_id:this.origin_id}};U.send(_()(e))}else this.getHistory()},show:function(t){var e=t.target.innerHTML.replace(/<div><br><\/div>/g,"").replace(/(&nbsp;)/g,""),a=d.a.trim(e).length;if(d.a.trim(t.target.innerText).length<=500)if(a>0){var s={event:"chat_reply",data:{open_id:this.open_id,origin_id:this.origin_id,cust_id:this.cust_id,msg:$.imgToEomoji(e),nickname:this.userName,avatar:this.userIcon,msg_type:"text"}};U.send(_()(s)),t.target.innerHTML="",this.showTip()}else t.target.innerHTML="";else this.open("输入已超出500个字")}}};function R(){U.close()}function D(t){if(console.log(t,9999),t.data.indexOf("code")>=0){var e=JSON.parse(t.data);if(console.log(e),1==e.code&&(P.beyond+=5,console.log("连续发送超过5条")),0==e.code){if("chat_reply"==e.event&&(console.log(e.data),console.log("chat_reply"),void 0!=e.data.open_id)){e.data.msg=$.emojiToImg(e.data.msg),P.msgsLists.push(e.data);var a=P.clientLists.length,s=0,i="",n="";if(a>1){for(var o=0;o<a;o++)if(P.clientLists[o].open_id==P.open_id){s=o,i=P.clientLists[o].status,n=P.clientLists[o].icon;break}if(s>0){P.clientLists.splice(s,1);var r={open_id:P.open_id,origin_id:P.origin_id,nickname:P.nickname,avatar:P.avatar,latest_msg:e.data.msg,updated_at:e.data.created_at,checked:!0,status:i,icon:n};P.clientLists.unshift(r)}}else P.clientLists[0].latest_msg=e.data.msg,P.clientLists[0].updated_at=e.data.created_at}if("chat_std"==e.data.event){console.log("chat_std");var l=e.data.open_id;if(0==e.code&&e.data.origin_id==P.origin_id01&&P.open_id==l){e.data.msg=$.emojiToImg(e.data.msg);for(o=0;o<P.clientLists.length;o++)P.clientLists[o].open_id==l&&(P.clientLists[o].created_at=e.data.created_at,P.clientLists[o].updated_at=e.data.created_at,P.clientLists[o].latest_msg=$.emojiToImg(e.data.msg));P.msgsLists.push(e.data)}else d.a.each(P.pro_client_list,function(t,a){if(a.proId==e.data.origin_id){P.prolsClientLists=JSON.parse(localStorage.getItem("clientLists"));for(var s=P.pro_client_list[t].clientLists,i=0;i<s.length;i++)if(s[i].open_id==l){s[i].num=parseInt(s[i].num)+1,s[i].created_at=e.data.created_at,s[i].latest_msg=$.emojiToImg(e.data.msg),P.totalUnreadNum=P.totalUnreadNum+1,console.log(parseInt(P.totalUnreadNum)),localStorage.setItem("totalUnreadNum",P.totalUnreadNum),P.pro_client_list[t].clientLists=s,localStorage.setItem("clientLists",_()(P.pro_client_list));break}}})}"chat_history"==e.event&&(console.log("chat_history"),console.log(e.event),e.data.length>0&&(P.msgsLists=e.data.reverse(),P.msgsLists.forEach(function(t){t.msg=$.emojiToImg(t.msg)})))}}var c=0;if(t.data.indexOf("nickname")>=0&&("transfer_student"==(e=JSON.parse(t.data)).event&&(console.log(e.data),e.data.latest_msg=$.emojiToImg(e.data.latest_msg),P.clientLists.unshift(e.data),P.accessStatus+=1),"wait_handle"==e.event)){var u=new Date;u=u.getTime(),e.data.state=1;var m=new Date(e.data.updated_at).getTime()+1728e5;e.data.overdue=Math.floor((m-u)/1e3/60/60)+"小时",console.log(P.waitingList),P.waitingList.forEach(function(t,a){e.data.open_id===t.open_id&&(c=2,e.data.msg_num=parseInt(d()(".djrlist li").eq(a).find(".msgnum").text())+1,e.data.updated_at=e.data.updated_at,P.waitingList.splice(a,1))}),2!=c&&(P.total1=parseInt(P.total)+1);for(var g=0;g<P.proList.length;g++)if(e.data.origin_id==P.proList[g].origin_id){e.data.icon=P.proList[g].icon;break}P.waitingList.unshift(e.data)}t.data.indexOf("open_id")>=0&&("remove_std"==(e=JSON.parse(t.data)).event&&P.waitingList.forEach(function(t,a){e.data.open_id===t.open_id&&P.waitingList.splice(a,1)}))}var O={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"height100"},[s("div",{class:0==t.tabNum?"chat_wrap":"chat_wrap displayN"},[s("div",{staticClass:"panel",class:t.showList?"panel":"panel displayN"},[s("div",{staticClass:"scroll-wrapper scrollbar-macosx chat-scroll"},[s("div",{staticClass:"scrollbar-macosx scroll-content scroll-chat-content",staticStyle:{height:"100%"},attrs:{"data-reactid":""}},[s("div",{staticClass:"overflow-h padding10 jj-box"},[s("div",{staticClass:"float_l"},[s("el-checkbox",{on:{change:function(e){t.changeRadio()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v("有效")])],1),t._v(" "),s("el-select",{staticClass:"float_r",attrs:{size:"mini",clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.updata},model:{value:t.origin_id01,callback:function(e){t.origin_id01=e},expression:"origin_id01"}},t._l(t.proList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.origin_id}})}))],1),t._v(" "),t._l(t.clientLists,function(e){return s("div",{key:e.id,staticClass:"card",class:{card_selected:e.checked},attrs:{"data-reactid":""},on:{click:function(a){t.currUser(e)}}},[s("div",{staticClass:"card_pic",attrs:{"data-reactid":""}},[s("img",{attrs:{"data-reactid":"",src:e.avatar,alt:e.nickname,title:e.nickname}}),t._v(" "),s("img",{staticClass:"logo",attrs:{src:e.icon}})]),t._v(" "),s("div",{staticClass:"card_content",attrs:{"data-reactid":""}},[s("div",{staticClass:"chat_content_header",attrs:{"data-reactid":""}},[s("span",{staticClass:"card_content_nick",attrs:{"data-reactid":""},domProps:{textContent:t._s(e.nickname)}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.showNum&&e.num>0,expression:"item.showNum && item.num>0"}],staticClass:"card_message_state",attrs:{"data-reactid":""},domProps:{textContent:t._s(e.num)}})]),t._v(" "),s("div",{staticClass:"card_content_chat",attrs:{"data-reactid":""}},[s("p",{staticClass:"card_content_detail",attrs:{"data-reactid":""},domProps:{innerHTML:t._s(e.latest_msg)}},[t._v("jkl")]),t._v(" "),"0"==e.status?s("span",{staticClass:"card_content_time",attrs:{"data-reactid":""},domProps:{textContent:t._s(e.updated_at)}}):t._e(),t._v(" "),"1"==e.status?s("span",{staticClass:"card_content_time",attrs:{"data-reactid":""}},[t._v("已过期")]):t._e()])])])})],2)])]),t._v(" "),s("Emoji",{directives:[{name:"show",rawName:"v-show",value:t.emojiShowFlag,expression:"emojiShowFlag"}],on:{onEmojiClick:t.getEmojiIdx}}),t._v(" "),s("div",{staticClass:"chat chat_no_input",class:t.showList?"chat_left":""},[s("div",{directives:[{name:"show",rawName:"v-show",value:t.showHistory,expression:"showHistory"}]},[s("div",{staticClass:"chat_header",attrs:{"data-reactid":""}},[s("div",{staticClass:"chat_header_items",attrs:{"data-reactid":""}},[s("span",{staticClass:"chat_header_name",attrs:{"data-reactid":""},domProps:{textContent:t._s(t.nickname)},on:{click:function(e){t.showLeftList()}}}),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.onlineFlag&&"0"==t.overdue,expression:"onlineFlag && overdue == '0'"}],staticClass:"chat_header_icons",attrs:{"data-reactid":""},on:{click:function(e){t.changeCust()}}},[s("span",{staticClass:"chat_header_icon transfer",attrs:{"data-reactid":""}})])])]),t._v(" "),s("div",{staticClass:"scroll-wrapper chat_body scrollbar-macosx",staticStyle:{position:"relative"}},[s("div",{staticClass:"chat_body scrollbar-macosx scroll-content scroll-scrolly_visible chat_body_h",attrs:{id:"wrap","data-reactid":""},nativeOn:{scroll:function(e){return t.handleScroll(e)}}},t._l(t.msgsLists,function(e,a){return s("div",{key:a,staticClass:"chat_body_inner",attrs:{"data-reactid":""}},[s("div",{directives:[{name:"show",rawName:"v-show",value:"std"===e.identity,expression:"item.identity === 'std'"}],staticClass:"message_box ",attrs:{"data-msgid":"751","data-reactid":""}},[s("div",{staticClass:"message_box_time",attrs:{"data-reactid":""},domProps:{textContent:t._s(e.created_at)}}),t._v(" "),s("img",{staticClass:"mssage_box_pic",staticStyle:{display:"inline-block"},attrs:{src:e.avatar,"data-is-me":"false","data-reactid":"",title:e.nickname}}),t._v(" "),s("div",{staticClass:"message_content",attrs:{"data-reactid":""}},[s("span",{attrs:{"data-reactid":""}}),t._v(" "),s("div",{staticClass:"message_content_inner",attrs:{"data-reactid":""}},["text"==e.msg_type?s("p",{domProps:{innerHTML:t._s(e.msg)}}):t._e(),t._v(" "),"image"==e.msg_type?s("p",[s("img",{staticStyle:{width:"100%"},attrs:{src:e.pic_url}})]):t._e(),t._v(" "),t._m(0,!0)])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:"teacher"===e.identity||"bot"===e.identity,expression:"item.identity === 'teacher' || item.identity === 'bot'"}],staticClass:"message_box from_self",attrs:{"data-msgid":"752","data-reactid":""}},[s("div",{staticClass:"message_box_time",attrs:{"data-reactid":""},domProps:{textContent:t._s(e.created_at)}}),t._v(" "),s("img",{staticClass:"mssage_box_pic",staticStyle:{display:"inline-block"},attrs:{src:t.userIcon,"data-is-me":"true","data-reactid":"",title:e.nickname}}),t._v(" "),s("div",{staticClass:"message_content",attrs:{"data-reactid":""}},[s("span",{attrs:{"data-reactid":""}}),t._v(" "),s("div",{staticClass:"message_content_inner",attrs:{"data-reactid":""}},["text"==e.msg_type?s("p",{attrs:{"data-reactid":""},domProps:{innerHTML:t._s(e.msg)}}):t._e(),t._v(" "),"image"==e.msg_type?s("p",[s("img",{staticStyle:{width:"100%"},attrs:{src:e.pic_url}})]):t._e(),t._v(" "),t._m(1,!0)])])])])}))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.onlineFlag&&"0"==t.overdue,expression:"onlineFlag && overdue == '0'"}],staticClass:"chat_edit",staticStyle:{display:"block"},attrs:{"data-reactid":".0.5.1.0.2.0.2"}},[s("div",{staticClass:"chat_edit_items",attrs:{"data-reactid":".0.5.1.0.2.0.2.0"}},[s("div",{staticClass:"chat_edit_icons",attrs:{"data-reactid":".0.5.1.0.2.0.2.0.0"}},[s("span",{staticClass:"chat_edit_icon emoji",attrs:{title:"表情",id:"toggler-btn"},on:{click:t.toggleEmoji}})])]),t._v(" "),s("div",{staticClass:"chat_edit_input",attrs:{"data-reactid":".0.5.1.0.2.0.2.1"}},[s("div",{staticClass:"scroll-wrapper edit_area scrollbar-macosx",staticStyle:{position:"relative"}},[s("pre",{ref:"editor",staticClass:"edit_area scrollbar-macosx scroll-content",attrs:{id:"editor",contenteditable:"true","data-reactid":""},domProps:{innerHTML:t._s(t.editContent)},on:{focus:t.focusPre,input:t.focusPre,keyup:function(e){return"button"in e||13===e.keyCode?t.show(e):null}}},[t._v("\n                        ")]),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:t.tipsShow,expression:"tipsShow"}],staticClass:"tips_p"},[t._v("最多可以输入500个字")]),t._v(" "),t._m(2),t._v(" "),t._m(3)])]),t._v(" "),s("div",{staticClass:"chat_edit_footer",attrs:{"data-reactid":".0.5.1.0.2.0.2.2"}},[t._v("\n                    按Enter发送，Ctrl+Enter换行\n                ")])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.showHistory,expression:"!showHistory"}],staticClass:"chat_not_pick",attrs:{"data-reactid":".0.5.1.0.2.0"}},[s("span",{staticClass:"wx_logo",attrs:{"data-reactid":".0.5.1.0.2.0.0"}}),t._v(" "),s("p",{staticClass:"not_pick_text",attrs:{"data-reactid":".0.5.1.0.2.0.1"}},[t._v("未选择聊天")])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1===t.custShow,expression:"custShow===1"}],staticClass:"transfer_popup",attrs:{"data-reactid":".0.5.1.3"}},[s("div",{staticClass:"transfer_chosen",attrs:{"data-reactid":".0.5.1.3.0"}},[t._m(4),t._v(" "),s("div",{staticClass:"scroll-wrapper transfer_cards scrollbar-macosx",staticStyle:{position:"relative"}},[s("div",{staticClass:"transfer_cards scrollbar-macosx scroll-content",staticStyle:{height:"210px","margin-bottom":"0px","margin-right":"0px","max-height":"none"},attrs:{"data-reactid":".0.5.1.3.0.1"}},t._l(t.custList,function(e,a){return s("div",{key:e.id,class:t.custChose!=a?"transfer_card":"transfer_card selected",attrs:{"data-reactid":".0.5.1.3.0.1.$229176575"},on:{click:function(s){t.chooseCust(a,e)}}},[s("span",{staticClass:"transfer_card_img",attrs:{"data-reactid":".0.5.1.3.0.1.$229176575.0"}},[s("img",{attrs:{src:e.avatar,"data-reactid":".0.5.1.3.0.1.$229176575.0.0"}})]),t._v(" "),s("div",{staticClass:"transfer_card_info",attrs:{"data-reactid":".0.5.1.3.0.1.$229176575.1"}},[s("p",{attrs:{"data-reactid":".0.5.1.3.0.1.$229176575.1.0"}},[t._v(t._s(e.name))]),t._v(" "),s("p",{staticClass:"transfer_card_assis",attrs:{"data-reactid":".0.5.1.3.0.1.$229176575.1.1"}},[t._v(t._s(e.nickname))])])])}))]),t._v(" "),s("div",{staticClass:"transfer_inputs",attrs:{"data-reactid":".0.5.1.3.0.2"}},[s("div",{staticClass:"transfer_input",attrs:{"data-reactid":".0.5.1.3.0.2.1"}},[s("div",{staticClass:"transfer_btn_wrap"},[s("span",{staticClass:"btn_wrap"},[s("a",{staticClass:"btn btn_primary",on:{click:function(e){t.changeCustBtn()}}},[t._v("转接")])]),t._v(" "),s("span",{staticClass:"btn_wrap"},[s("a",{staticClass:"btn btn_default",on:{click:function(e){t.delChangeCustBtn()}}},[t._v("取消")])])])])])])])])],1),t._v(" "),s("div",{class:1==t.tabNum?"waiting_wrap fff-bg":"waiting_wrap fff-bg displayN"},[s("div",{staticClass:"waiting_inner"},[s("div",{staticClass:"waiting_panel"},[s("div",{class:0==t.curIndex?"setting_panel choose":"setting_panel",attrs:{"data-index":"0"},on:{click:function(e){t.changeTab(e)}}},[t._v("待接入会话")]),t._v(" "),s("div",{class:1==t.curIndex?"setting_panel choose":"setting_panel",attrs:{"data-index":"1"},on:{click:function(e){t.changeTab(e)}}},[t._v("已过期会话")]),t._v(" "),s("el-select",{staticClass:"float_r seting_select",attrs:{size:"mini",clearable:"",filterable:"",placeholder:"请选择"},on:{change:t.updata},model:{value:t.origin_id02,callback:function(e){t.origin_id02=e},expression:"origin_id02"}},t._l(t.proList,function(t){return s("el-option",{key:t.id,attrs:{label:t.name,value:t.origin_id}})}))],1),t._v(" "),s("div",{staticClass:"waiting_box"},[s("div",{staticClass:"scoll_wrapper wait_list"},[s("div",{staticClass:"wait_list"},[s("div",{class:0==t.curIndex?"displayB":"displayN"},[s("ul",{directives:[{name:"show",rawName:"v-show",value:t.waitingList.length>0,expression:"waitingList.length>0"}],staticClass:"list_ul djrlist"},t._l(t.waitingList,function(e){return s("li",{key:e.id,staticClass:"wait_li position-r"},[s("div",{staticClass:"li_img position-a"},[s("img",{attrs:{src:e.avatar}}),t._v(" "),s("span",{staticClass:"img_span colorfff position-a msgnum"},[t._v(t._s(e.msg_num))]),t._v(" "),s("span",{staticClass:"img_img colorfff position-a "},[s("img",{attrs:{src:e.icon}})])]),t._v(" "),s("div",{staticClass:"div_info"},[s("div",{staticClass:"overflow-h span-div"},[s("span",{staticClass:"float_l fontweight_b color333 margin_r10",domProps:{textContent:t._s(e.nickname)}}),t._v(" "),s("span",{staticClass:"float_l color999 margin_r10 created",domProps:{textContent:t._s(e.updated_at)}}),t._v(" "),s("span",{staticClass:"float_l color999 overdue"},[t._v(t._s(e.overdue))]),s("span",{staticClass:"float_l color999"},[t._v("过期")])]),t._v(" "),s("p",{staticClass:"color666 msg",domProps:{innerHTML:t._s(e.latest_msg.msg)}})]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:1==e.state,expression:"item.state==1"}],staticClass:"position-a li-btn",attrs:{type:"success",size:"mini"},on:{click:function(a){t.accessFun(e)}}},[t._v("接入会话")]),t._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:0==e.state,expression:"item.state==0"}],staticClass:"position-a li-btn",attrs:{type:"primary",size:"mini",loading:!0}},[t._v("等待接入")])],1)})),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:0==t.waitingList.length,expression:"waitingList.length==0"}],staticClass:"text_c"},[t._v("暂无待接入会话记录")])]),t._v(" "),s("div",{class:1==t.curIndex?"displayB":"displayN"},[s("ul",{directives:[{name:"show",rawName:"v-show",value:t.overdueList.length>0,expression:"overdueList.length>0"}],staticClass:"list_ul"},[t._l(t.overdueList,function(e){return s("li",{key:e.id,staticClass:"wait_li position-r"},[s("div",{staticClass:"li_img position-a"},[s("img",{attrs:{src:e.avatar}}),t._v(" "),s("span",{staticClass:"img_span colorfff position-a displayN"},[t._v(t._s(e.msg_num))]),t._v(" "),"gh_f4546e33a886"==e.origin_id?s("span",{staticClass:"img_img colorfff position-a "},[s("img",{attrs:{src:a("e1qu")}})]):t._e()]),t._v(" "),s("div",{staticClass:"div_info"},[s("div",{staticClass:"overflow-h"},[s("span",{staticClass:"float_l fontweight_b color333 margin_r10",domProps:{textContent:t._s(e.nickname)}}),t._v(" "),s("span",{staticClass:"float_l color999 margin_r10",domProps:{textContent:t._s(e.updated_at)}})]),t._v(" "),s("p",{staticClass:"color666",domProps:{innerHTML:t._s(e.latest_msg.msg)}})]),t._v(" "),s("el-button",{staticClass:"position-a li-btn",attrs:{type:"info",plain:"",disabled:"",size:"mini"}},[t._v("已过期")])],1)}),t._v(" "),t._m(5)],2),t._v(" "),s("p",{directives:[{name:"show",rawName:"v-show",value:0==t.overdueList.length,expression:"overdueList.length==0"}],staticClass:"text_c"},[t._v("暂无已过期会话记录")])]),t._v(" "),t.pageShow?s("el-pagination",{staticClass:"page-wrap",attrs:{"current-page":t.page,"page-size":t.pageSize,layout:"total, prev, pager, next,jumper",total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.page=e}}}):t._e()],1)])])])])])},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"message_content_detecting",attrs:{"data-reactid":""}},[e("span",{staticClass:"first",attrs:{"data-reactid":""}}),this._v(" "),e("span",{staticClass:"second",attrs:{"data-reactid":""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"message_content_detecting",attrs:{"data-reactid":""}},[e("span",{staticClass:"first",attrs:{"data-reactid":""}}),this._v(" "),e("span",{staticClass:"second",attrs:{"data-reactid":""}})])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"scroll-element scroll-x"},[e("div",{staticClass:"scroll-element_outer"},[e("div",{staticClass:"scroll-element_size"}),this._v(" "),e("div",{staticClass:"scroll-element_track"}),this._v(" "),e("div",{staticClass:"scroll-bar",staticStyle:{width:"96px"}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"scroll-element scroll-y"},[e("div",{staticClass:"scroll-element_outer"},[e("div",{staticClass:"scroll-element_size"}),this._v(" "),e("div",{staticClass:"scroll-element_track"}),this._v(" "),e("div",{staticClass:"scroll-bar",staticStyle:{height:"96px"}})])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"transfer_header overflow-h",attrs:{"data-reactid":".0.5.1.3.0.0"}},[e("span",{staticClass:"float_l"},[this._v("请选择要转接的客服")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("li",{staticClass:"wait_li position-r borderN"},[e("p",{staticClass:"text_c"},[this._v("只展示最近5天的数据")])])}]};var q=a("VU/8")(z,O,!1,function(t){a("U0ms"),a("gcXV"),a("HzwQ"),a("4XJR")},"data-v-56f5a60c",null).exports;a("XiTZ");s.default.use(o.a),s.default.use(r.a);var H=new r.a({routes:[{path:"/",name:"login",component:y},{path:"/index",name:"index",component:g,children:[{path:"/index",name:"Conversation",component:q},{path:"/Setting",name:"Setting",component:function(){return new Promise(function(t){t()}).then(a.bind(null,"XiTZ"))}}]}]}),B=a("zL8q"),V=a.n(B),W=(a("tvR6"),a("mtWM")),G=a.n(W);s.default.use(o.a);var X=new o.a.Store({name:"store",state:{count:1}});window.$=d.a;var J=localStorage.getItem("Token");J&&v.a.setToken(J),s.default.prototype.$http=G.a,s.default.use(V.a),s.default.config.productionTip=!1,new s.default({el:"#app",router:H,store:X,components:{App:n},template:"<App/>"})},OiEn:function(t,e){},U0ms:function(t,e){},UNrT:function(t,e,a){t.exports=a.p+"static/img/timg.ed1be2f.jpg"},XiTZ:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("woOf"),i=a.n(s),n=a("Gu7T"),o=a.n(n),r=a("cKc3"),l=a("mtWM"),c=a.n(l),d=a("34QF"),u={name:"index",data:function(){return{userTotal:0,userList:[],userPage:1,pageShow:!1,localTotal:"",localPage:1,globalPage:1,globalReplay:[],globalReplayAll:[],globalReplayId:[],globalTotal:0,isGlobalAdd:!1,isLocalAdd:!1,isGlobalUpload:!1,isLocalUpload:!1,pageSize:10,ifBox:!1,cover:!1,radio:"1",tabStatus:1,ifinput:[{value:""}],product_id:"",prdList:[],textarea:"",content:"",getIfList:[],from:{id:"",product_id:"",answer:"",type:"0",is_global:0},conditions:[{value:""}],btnType:1,editAccountDialog:!1,isEditAccount:!1,accountForm:{root:0,type_id:[]},replayManageDialog:!1,isEditReplay:!1,replayManageForm:{type:"0",answer:""},totalUnreadNum:0}},created:function(){var t=this;d.a.getPro().then(function(e){t.prdList=e.data});var e=parseInt(localStorage.getItem("totalUnreadNum"));isNaN(e)?this.totalUnreadNum=0:this.totalUnreadNum=e,t.getCustomerList(),t.getIfListLocal(),t.getIfListGlobal()},mounted:function(){},watch:{totalUnreadNum:function(){this.$emit("msgTotal",this.totalUnreadNum)}},methods:{getCustomerList:function(){var t=this;d.a.getCustomerList({product_id:t.product_id,page:this.userPage,page_size:10}).then(function(e){0==e.code&&(t.userList=e.data,t.userTotal=e.total)})},userPageChange:function(t){this.userPage=t,this.getCustomerList()},getIfListLocal:function(){var t=this,e={page:this.localPage,page_size:this.pageSize,product_id:this.product_id,is_global:0};d.a.getIfList(e).then(function(e){if(0==e.code){var a=e.data;t.localTotal=e.total||[],t.total>5&&(t.pageShow=!0),console.log("here"),t.getIfList=a}})},replayLocalChange:function(t){this.localPage=t,this.getIfListLocal()},getIfListGlobal:function(){var t=this,e={page:this.globalPage,page_size:999,product_id:this.product_id,is_global:1};d.a.getIfList(e).then(function(e){0==e.code&&(t.globalReplay=e.data||[],t.product_id||(t.globalReplayAll=[].concat(o()(e.data))),t.globalReplayAll.length>0&&(t.globalReplayId=t.globalReplayAll.map(function(t){return t.product_id})),t.globalTotal=e.total)})},clickUpdate:function(t){var e=this;e.cover=!0,e.ifBox=!0,e.from=i()({},t),setTimeout(function(){e.$refs.from&&e.$refs.from.clearValidate()});var a=[];t.conditions.split(",").forEach(function(t){a.push({value:t})}),e.conditions=a,this.btnType=1},commit:function(t){1===t?this.update():2===t&&this.create()},update:function(){var t=this,e=this,a=[];e.conditions.forEach(function(t){a.push(t.value)}),e.from.conditions=a.join(","),e.$refs.from.validate(function(a){if(!a)return console.log("error submit!!"),!1;e.from.conditions.length>0?(e.isLocalAdd=!0,d.a.update(e.from).then(function(a){e.isLocalAdd=!1,"ok"===a.msg?(t.$message({message:"操作成功",type:"success"}),e.closeBox(),e.localPage=1,e.getIfListLocal()):t.$message.error(a.msg)})):t.$message.error("请输入条件！")})},create:function(){var t=this,e=this,a=[];e.conditions.forEach(function(t){a.push(t.value)}),e.from.conditions=a.join(","),e.$refs.from.validate(function(a){if(!a)return console.log("error submit!!"),!1;e.from.conditions.length>0?(e.isLocalAdd=!0,d.a.create(e.from).then(function(a){e.isLocalAdd=!1,"ok"===a.msg?(t.$message({message:"操作成功",type:"success"}),e.closeBox(),e.localPage=1,e.getIfListLocal()):t.$message.error(a.msg)})):t.$message.error("请输入条件！")})},clickDelete:function(t){var e=this,a=this;this.$confirm("确定要删除该记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){var s={id:parseInt(t.id)};d.a.clickDelete(s).then(function(t){"ok"===t.msg?(e.$message({message:"删除成功",type:"success"}),a.closeBox(),a.getIfListLocal()):e.$message({message:t.msg,type:"error"})})}).catch(function(){})},changeTab:function(t){this.tabStatus=t,1==this.tabStatus?(this.userPage=1,this.getCustomerList()):2==this.tabStatus?(this.page=1,this.getIfListLocal()):(this.globalPage=1,this.getIfListGlobal())},open4:function(){this.cover=!0,this.ifBox=!0;var t=this;setTimeout(function(){t.$refs.from&&t.$refs.from.clearValidate()}),this.from={product_id:"",answer:"",type:"0",is_global:0},this.conditions=[{value:""}],this.btnType=2},closeBox:function(){this.ifBox=!1,this.cover=!1},addArraw:function(){this.conditions.push({value:""})},deleteArraw:function(t){this.conditions.length>1&&this.conditions.splice(t,1)},changeAccountStatus:function(t){var e=this;e.$confirm("确定要"+(1==t.disable?"启用":"禁用")+"该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){1==t.disable?d.a.enableAccount({id:t.id}).then(function(t){"ok"==t.msg?(e.$message.success("操作成功！"),e.userPage=1,e.getCustomerList()):e.$message.error(t.data)}):d.a.disableAccount({id:t.id}).then(function(t){"ok"==t.msg?(e.$message.success("操作成功！"),e.userPage=1,e.getCustomerList()):e.$message.error(t.data)})}).catch(function(){})},deleteAccount:function(t){var e=this;e.$confirm("确定要删除该用户?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){d.a.deleteAccount({id:t}).then(function(t){"ok"==t.msg?(e.$message.success("操作成功！"),e.userPage=1,e.getCustomerList()):e.$message.error(t.msg)})}).catch(function(){})},editAccount:function(t){var e=this;for(var a in e.editAccountDialog=!0,setTimeout(function(){e.$refs.accountForm&&e.$refs.accountForm.clearValidate()}),e.isEditAccount=!0,t)e.accountForm[a]=t[a];t.product_list&&t.product_list.length>0?e.accountForm.type_id=t.product_list.map(function(t){return t.id}):e.accountForm.type_id=[],e.accountForm.customer_id=t.id,e.accountForm.root=1*e.accountForm.root},addAccount:function(){var t=this;t.editAccountDialog=!0,t.isEditAccount=!1,setTimeout(function(){t.$refs.accountForm&&t.$refs.accountForm.clearValidate()}),t.accountForm={root:0,type_id:[]}},saveAccount:function(){var t=this,e=this;e.$refs.accountForm.validate(function(a){if(!a)return console.log("error submit!!"),!1;e.accountForm.type_id.length>0?e.isEditAccount?(1!=e.accountForm.root&&(e.accountForm.type_id=[e.accountForm.type_id[0]]),d.a.updateUser(e.accountForm).then(function(t){"ok"==t.msg?(e.$message.success("操作成功"),e.editAccountDialog=!1,e.userPage=1,e.getCustomerList()):e.$message.error(t.data)})):d.a.saveAccount(e.accountForm).then(function(t){0==t.code?(e.$message.success("操作成功"),e.editAccountDialog=!1,e.userPage=1,e.getCustomerList()):e.$message.error(t.msg)}):t.$message.error("请选择产品！")})},replayGlobalChange:function(t){this.globalPage=t,this.getIfListGlobal()},addReplyGlobal:function(){var t=this;t.isEditReplay=!1,t.replayManageDialog=!0,setTimeout(function(){t.$refs.replayManageForm&&t.$refs.replayManageForm.clearValidate()}),t.replayManageForm={type:"0",answer:""}},globalEdit:function(t){var e=this;e.replayManageDialog=!0,console.log(t),setTimeout(function(){e.$refs.replayManageForm&&e.$refs.replayManageForm.clearValidate()}),e.replayManageForm=i()({},t),e.isEditReplay=!0},globalDelete:function(t){var e=this;e.$confirm("确定要删除该记录?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){d.a.clickDelete({id:1*t.id}).then(function(t){"ok"==t.msg?(e.$message.success("操作成功！"),e.globalPage=1,e.getIfListGlobal()):e.$message.error(t.msg)})}).catch(function(){})},replayManageSave:function(){var t=this,e=this;e.replayManageForm.is_global=1,e.$refs.replayManageForm.validate(function(a){if(!a)return console.log("error submit!!"),!1;e.isGlobalAdd=!0,e.isEditReplay?d.a.update(e.replayManageForm).then(function(a){e.isGlobalAdd=!1,"ok"===a.msg?(t.$message({message:"操作成功",type:"success"}),e.replayManageDialog=!1,e.globalPage=1,e.getIfListGlobal()):t.$message({message:a.msg,type:"error"})}):d.a.create(e.replayManageForm).then(function(a){e.isGlobalAdd=!1,"ok"===a.msg?(t.$message({message:"操作成功",type:"success"}),e.replayManageDialog=!1,e.globalPage=1,e.getIfListGlobal()):t.$message({message:a.msg,type:"error"})})})},localUploadFile:function(t){var e=this;t.target.files[0]&&(e.isLocalUpload=!0,e.$refs.from.clearValidate(["answer"]),e.uploadFile(t,function(t){e.isLocalUpload=!1,e.from.answer=t}))},globalUploadFile:function(t){var e=this;t.target.files[0]&&(e.isGlobalUpload=!0,e.$refs.replayManageForm.clearValidate(["answer"]),e.uploadFile(t,function(t){e.isGlobalUpload=!1,e.replayManageForm.answer=t}))},uploadFile:function(t,e){r.a.get("oss/token/generate").then(function(a){var s=JSON.parse(a.data.data);console.log(s);var i=s.data||{},n=new FormData,o="reply"+(new Date).getTime(),r=i.dir+"/"+o;n.append("key",r),n.append("policy",i.policy),n.append("OSSAccessKeyId",i.accessid),n.append("success_action_status","200"),n.append("signature",i.signature),n.append("callback",i.callback),n.append("file",t.target.files[0]),c.a.post(i.host,n).then(function(t){console.log(t.data.data.url),e&&e(t.data.data.url)}).catch(function(t){console.log(t)})})},localTypeChange:function(t){var e=this;e.from.answer="",e.$nextTick(function(){e.$refs.from.clearValidate(["answer"])})},globalTypeChange:function(t){var e=this;e.replayManageForm.answer="",e.$nextTick(function(){e.$refs.replayManageForm.clearValidate(["answer"])})}}},m={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"height100"},[s("div",{staticClass:"content-box"},[s("div",{staticClass:"title clearfloat"},[s("ul",{staticClass:"tab-list pull-left"},[s("li",{class:{active:1===t.tabStatus},on:{click:function(e){t.changeTab(1)}}},[t._v("客服管理")]),t._v(" "),s("li",{class:{active:2===t.tabStatus},on:{click:function(e){t.changeTab(2)}}},[t._v("条件自动回复管理")]),t._v(" "),s("li",{class:{active:3===t.tabStatus},on:{click:function(e){t.changeTab(3)}}},[t._v("全局自动回复管理")])]),t._v(" "),s("div",{staticClass:"pull-right"},[s("el-select",{staticClass:"float_r",attrs:{size:"mini",clearable:"",filterable:"",placeholder:"请选择产品"},on:{change:function(e){t.changeTab(t.tabStatus)}},model:{value:t.product_id,callback:function(e){t.product_id=e},expression:"product_id"}},t._l(t.prdList,function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1)]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:1===t.tabStatus,expression:"tabStatus===1"}],staticClass:"setting_box"},[s("ul",{staticClass:"content-list"},t._l(t.userList,function(e,i){return s("li",{key:i,staticClass:"item position-r"},[s("div",{staticClass:"li_img position-a"},[e.avatar?t._e():s("img",{attrs:{src:a("q88x")}}),t._v(" "),e.avatar?s("img",{attrs:{src:e.avatar}}):t._e()]),t._v(" "),s("div",{staticClass:"div_info"},[s("div",{staticClass:"overflow-h"},[s("span",{staticClass:"float_l fontweight_b color333 margin_r10"},[t._v(t._s(e.name))]),t._v(" "),s("span",{staticClass:"float_l color999 margin_r10"},[t._v(t._s(e.nickname))])]),t._v(" "),s("p",{staticClass:"color666"},[s("el-tag",{staticClass:"margin_r10",attrs:{type:"info",size:"mini"}},[t._v(t._s(1==e.root?"管理员":"客服"))]),t._v("\n              绑定产品："),t._l(e.product_list||[],function(e,a){return s("span",{key:a},[0!=a?s("span",[t._v(",")]):t._e(),t._v(t._s(e.name))])})],2)]),t._v(" "),s("div",{staticClass:"position-a li-btn"},[s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.editAccount(e)}}},[t._v("修改")]),t._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.changeAccountStatus(e)}}},[t._v(t._s(1==e.disable?"启用":"禁用")+"\n            ")]),t._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.deleteAccount(e.id)}}},[t._v("删除")])],1)])})),t._v(" "),0==t.userList.length?s("div",{staticClass:"text-center text-gary"},[s("br"),s("br"),s("br"),t._v("\n        暂无数据\n        "),s("br"),s("br"),s("br")]):t._e(),t._v(" "),t.userList.length>0?s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:1*t.userTotal,"current-page":t.userPage},on:{"update:currentPage":function(e){t.userPage=e},"current-change":t.userPageChange}}):t._e(),t._v(" "),s("button",{staticClass:"btn btn-primary pull-right",on:{click:t.addAccount}},[t._v("添加账号")]),t._v(" "),s("div",{staticClass:"clearfloat"}),t._v(" "),s("el-dialog",{attrs:{title:(t.isEditAccount?"编辑":"添加")+"账号",visible:t.editAccountDialog,width:"500px"},on:{"update:visible":function(e){t.editAccountDialog=e}}},[s("el-form",{ref:"accountForm",attrs:{model:t.accountForm,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"账号",prop:"name",rules:[{required:!0,message:"请输入账号",trigger:"blur",validator:function(t,e,a){e&&""!=e.trim()?a():a("请输入账号")}}]}},[s("el-col",{attrs:{span:20}},[s("el-input",{attrs:{disabled:t.isEditAccount,placeholder:"请输入账号",size:"small"},model:{value:t.accountForm.name,callback:function(e){t.$set(t.accountForm,"name",e)},expression:"accountForm.name"}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"昵称",prop:"nickname",rules:[{required:!0,message:"请输入昵称",trigger:"blur",validator:function(t,e,a){e&&""!=e.trim()?a():a("请输入账号")}}]}},[s("el-col",{attrs:{span:20}},[s("el-input",{attrs:{size:"small",placeholder:"请输入昵称"},model:{value:t.accountForm.nickname,callback:function(e){t.$set(t.accountForm,"nickname",e)},expression:"accountForm.nickname"}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"密码",prop:"password",rules:[{required:!t.isEditAccount,message:"请输入昵称"}]}},[s("el-col",{attrs:{span:20}},[s("el-input",{attrs:{type:"password",placeholder:t.isEditAccount?"不修改密码请留空":"请输入密码",size:"small"},model:{value:t.accountForm.password,callback:function(e){t.$set(t.accountForm,"password",e)},expression:"accountForm.password"}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"类别"}},[s("el-radio-group",{model:{value:t.accountForm.root,callback:function(e){t.$set(t.accountForm,"root",e)},expression:"accountForm.root"}},[s("el-radio",{attrs:{label:1}},[t._v("管理员")]),t._v(" "),s("el-radio",{attrs:{label:0}},[t._v("客服")])],1)],1),t._v(" "),1==t.accountForm.root?s("el-form-item",{attrs:{label:"产品"}},[s("el-checkbox-group",{model:{value:t.accountForm.type_id,callback:function(e){t.$set(t.accountForm,"type_id",e)},expression:"accountForm.type_id"}},t._l(t.prdList,function(e,a){return s("el-checkbox",{key:a,attrs:{label:e.id}},[t._v(t._s(e.name)+"\n              ")])}))],1):t._e(),t._v(" "),1!=t.accountForm.root?s("el-form-item",{attrs:{label:"产品"}},[s("el-radio-group",{model:{value:t.accountForm.type_id[0],callback:function(e){t.$set(t.accountForm.type_id,0,e)},expression:"accountForm.type_id[0]"}},t._l(t.prdList,function(e,a){return s("el-radio",{key:a,attrs:{label:e.id,name:"type_id"}},[t._v(t._s(e.name)+"\n              ")])}))],1):t._e()],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.editAccountDialog=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.saveAccount}},[t._v("确 定")])],1)],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:2===t.tabStatus,expression:"tabStatus===2"}],staticClass:"setting_box"},[s("ul",{staticClass:"content-list"},t._l(t.getIfList,function(e,i){return s("li",{key:i,staticClass:"item position-r"},[s("div",{staticClass:"li_img position-a"},[e.icon?t._e():s("img",{attrs:{src:a("q88x")}}),t._v(" "),e.icon?s("img",{attrs:{src:e.icon}}):t._e()]),t._v(" "),s("div",{staticClass:"div_info"},[s("p",{staticClass:"color333"},[s("span",{staticClass:"color999"},[t._v("条件:")]),t._v(t._s(e.conditions))]),t._v(" "),s("p",{staticClass:"color333"},[s("span",{staticClass:"color999"},[t._v("回复:")]),t._v(t._s(e.answer))])]),t._v(" "),s("div",{staticClass:"position-a li-btn"},[s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.clickUpdate(e)}}},[t._v("修改")]),t._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.clickDelete(e)}}},[t._v("删除")])],1)])})),t._v(" "),0==t.getIfList.length?s("div",{staticClass:"text-center text-gary"},[s("br"),s("br"),s("br"),t._v("\n        暂无数据\n        "),s("br"),s("br"),s("br")]):t._e(),t._v(" "),t.getIfList.length>0?s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:1*t.localTotal,"current-page":t.localPage},on:{"update:currentPage":function(e){t.localPage=e},"current-change":t.replayLocalChange}}):t._e(),t._v(" "),s("div",{staticClass:"overflow-h"},[s("el-button",{staticClass:"pull-right",attrs:{type:"primary"},on:{click:t.open4}},[t._v("添加条件回复")])],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:3===t.tabStatus,expression:"tabStatus===3"}],staticClass:"setting_box"},[s("ul",{staticClass:"content-list"},t._l(t.globalReplay,function(e,i){return s("li",{key:i,staticClass:"item position-r"},[s("div",{staticClass:"li_img position-a"},[e.icon?t._e():s("img",{attrs:{src:a("q88x")}}),t._v(" "),e.icon?s("img",{attrs:{src:e.icon}}):t._e()]),t._v(" "),s("div",{staticClass:"div_info"},[s("p",{staticClass:"color333"},[t._v("全局自动回复")]),t._v(" "),s("p",{staticClass:"color333"},[s("span",{staticClass:"color999"},[t._v("回复:")]),t._v(t._s(e.answer))])]),t._v(" "),s("div",{staticClass:"position-a li-btn"},[s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.globalEdit(e)}}},[t._v("修改")]),t._v(" "),s("el-button",{attrs:{type:"text",size:"mini"},on:{click:function(a){t.globalDelete(e)}}},[t._v("删除")])],1)])})),t._v(" "),0==t.globalReplay.length?s("div",{staticClass:"text-center text-gary"},[s("br"),s("br"),s("br"),t._v("\n        暂无数据\n        "),s("br"),s("br"),s("br")]):t._e(),t._v(" "),t.globalReplay.length>0&&1*t.globalTotal>10?s("el-pagination",{attrs:{small:"",layout:"prev, pager, next",total:1*t.globalTotal,"current-page":t.globalPage},on:{"update:currentPage":function(e){t.globalPage=e},"current-change":t.replayGlobalChange}}):t._e(),t._v(" "),s("div",{staticClass:"overflow-h"},[s("el-button",{staticClass:"pull-right",attrs:{type:"primary"},on:{click:t.addReplyGlobal}},[t._v("添加全局回复\n        ")])],1)],1),t._v(" "),s("el-dialog",{attrs:{title:(t.isEditReplay?"编辑":"添加")+"全局回复",visible:t.replayManageDialog,width:"500px"},on:{"update:visible":function(e){t.replayManageDialog=e}}},[s("el-form",{ref:"replayManageForm",attrs:{model:t.replayManageForm,"label-width":"80px"}},[s("el-form-item",{attrs:{label:"选择产品",prop:"product_id",rules:[{required:!0,message:"请选择产品"}]}},[s("el-col",{attrs:{span:14}},[s("el-select",{attrs:{size:"small",disabled:t.isEditReplay,placeholder:"选择产品"},model:{value:t.replayManageForm.product_id,callback:function(e){t.$set(t.replayManageForm,"product_id",e)},expression:"replayManageForm.product_id"}},t._l(t.prdList,function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id}})}))],1),t._v(" "),t.globalReplayId.indexOf(t.replayManageForm.product_id)>-1&&!t.isEditReplay?s("el-col",{attrs:{span:10}},[s("p",{staticStyle:{color:"#f00"}},[t._v("该产品已有全局自动回复")])]):t._e()],1),t._v(" "),s("el-form-item",{attrs:{label:"回复类别"}},[s("el-radio-group",{on:{change:t.globalTypeChange},model:{value:t.replayManageForm.type,callback:function(e){t.$set(t.replayManageForm,"type",e)},expression:"replayManageForm.type"}},[s("el-radio",{attrs:{label:"0"}},[t._v("文本")]),t._v(" "),s("el-radio",{attrs:{label:"1"}},[t._v("图片")])],1)],1),t._v(" "),0==t.replayManageForm.type?s("el-form-item",{attrs:{label:"回复内容",prop:"answer",rules:[{required:!0,message:"请输入回复内容"}]}},[s("el-col",{attrs:{span:20}},[s("el-input",{attrs:{type:"textarea"},model:{value:t.replayManageForm.answer,callback:function(e){t.$set(t.replayManageForm,"answer",e)},expression:"replayManageForm.answer"}})],1)],1):t._e(),t._v(" "),1==t.replayManageForm.type?s("el-form-item",{attrs:{label:"回复内容",prop:"answer",rules:[{required:!0,message:"请选择文件"}]}},[s("el-col",{attrs:{span:20}},[s("input",{attrs:{type:"file",accept:"image/*"},on:{change:t.globalUploadFile}}),t._v(" "),t.isGlobalUpload?s("p",{staticStyle:{color:"#999"}},[t._v("图片上传中...")]):t._e()])],1):t._e()],1),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.replayManageDialog=!1}}},[t._v("取 消")]),t._v(" "),s("el-button",{attrs:{type:"primary",disabled:t.globalReplayId.indexOf(t.replayManageForm.product_id)>-1&&!t.isEditReplay||t.isGlobalAdd||t.isGlobalUpload},on:{click:t.replayManageSave}},[t._v("确 定")])],1)],1)],1),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.ifBox,expression:"ifBox"}],staticClass:"el-message-box__wrapper",staticStyle:{"z-index":"2003"},attrs:{tabindex:"-1",role:"dialog"}},[s("div",{staticClass:"el-message-box"},[s("div",{staticClass:"el-message-box__header"},[s("div",{staticClass:"el-message-box__title"},[s("span",[t._v(t._s(1==t.btnType?"修改":"添加")+"条件回复")])]),t._v(" "),s("button",{staticClass:"el-message-box__headerbtn",attrs:{type:"button","aria-label":"Close"},on:{click:t.closeBox}},[s("i",{staticClass:"el-message-box__close el-icon-close"})])]),t._v(" "),s("div",{staticClass:"el-message-box__content",attrs:{"data-id":"from.id"}},[s("el-form",{ref:"from",staticClass:"el-message-box__message",attrs:{model:t.from,"label-width":"95px"}},[s("el-form-item",{attrs:{label:"选择产品：",prop:"product_id",rules:[{required:!0,message:"请选择产品"}]}},[s("el-select",{staticClass:"float_l margin-r10",attrs:{size:"small",disabled:1==t.btnType,clearable:"",filterable:"",placeholder:"请选择产品"},model:{value:t.from.product_id,callback:function(e){t.$set(t.from,"product_id",e)},expression:"from.product_id"}},t._l(t.prdList,function(t,e){return s("el-option",{key:e,attrs:{label:t.name,value:t.id+""}})}))],1),t._v(" "),s("el-form-item",{attrs:{label:"用户消息："}},[t._l(t.conditions,function(e,a){return s("div",{key:a,staticClass:"news_div overflow-h margin_b10"},[s("el-input",{staticClass:"float_l width200 margin-r10",attrs:{maxlength:"",size:"small",placeholder:"请输入内容"},model:{value:e.value,callback:function(a){t.$set(e,"value",a)},expression:"item.value"}}),t._v(" "),s("i",{staticClass:"fontsize20 el-icon-circle-close-outline margin-r10 float_r lingheight32",on:{click:function(e){t.deleteArraw(a)}}})],1)}),t._v(" "),s("i",{staticClass:"fontsize20 el-icon-circle-plus-outline position-a lingheight32 position_icon",on:{click:t.addArraw}})],2),t._v(" "),s("el-form-item",{attrs:{label:"回复类别："}},[s("el-radio-group",{on:{change:t.localTypeChange},model:{value:t.from.type,callback:function(e){t.$set(t.from,"type",e)},expression:"from.type"}},[s("el-radio",{attrs:{label:"0"}},[t._v("文本")]),t._v(" "),s("el-radio",{attrs:{label:"1"}},[t._v("图片")])],1)],1),t._v(" "),0==t.from.type?s("el-form-item",{attrs:{label:"回复内容：",prop:"answer",rules:[{required:!0,message:"请输入回复内容"}]}},[s("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入内容"},model:{value:t.from.answer,callback:function(e){t.$set(t.from,"answer",e)},expression:"from.answer"}})],1):t._e(),t._v(" "),1==t.from.type?s("el-form-item",{attrs:{label:"回复内容：",prop:"answer",rules:[{required:!0,message:"请选择文件"}]}},[s("el-col",{attrs:{span:20}},[s("input",{attrs:{type:"file",accept:"image/*"},on:{change:t.localUploadFile}}),t._v(" "),t.isLocalUpload?s("p",{staticStyle:{color:"#999"}},[t._v("图片上传中...")]):t._e()])],1):t._e()],1)],1),t._v(" "),s("div",{staticClass:"el-message-box__btns"},[s("button",{staticClass:"el-button el-button--default el-button--small",attrs:{type:"button"},on:{click:t.closeBox}},[s("span",[t._v("\n        取消\n      ")])]),t._v(" "),s("el-button",{attrs:{type:"primary",size:"small",disabled:t.isLocalAdd||t.isLocalUpload},on:{click:function(e){t.commit(t.btnType)}}},[s("span",[t._v("\n        确定\n      ")])])],1)])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!0===t.cover,expression:"cover===true"}],staticClass:"v-modal",staticStyle:{"z-index":"2000"},attrs:{tabindex:"0"}})])},staticRenderFns:[]};var g=a("VU/8")(u,m,!1,function(t){a("2r5n"),a("DD6N")},"data-v-6ec1bdd0",null);e.default=g.exports},cKc3:function(t,e,a){"use strict";var s=a("mvHQ"),i=a.n(s),n=a("woOf"),o=a.n(n),r=a("//Fk"),l=a.n(r),c=a("mtWM"),d=a.n(c),u=a("mw3O"),m=a.n(u),g=a("zL8q"),p=(a.n(g),d.a.create({}));p.defaults.baseURL=API_URL||"http://qa-webim-api.toutiao.com";var _=void 0;p.defaults.headers.post["X-Requested-With"]="XMLHttpRequest",p.defaults.headers.get["X-Requested-With"]="XMLHttpRequest",p.defaults.responseType="json",p.defaults.headers["Content-Type"]="application/json;charset=utf-8",p.defaults.validateStatus=function(t){return!0},p.defaults.timeout=15e3,p.interceptors.request.use(function(t){return t.headers.Accept="application/json",t},function(t){return Object(g.Message)({message:"服务器响应超时，请稍后重试。",type:"error",duration:5e3}),l.a.reject(t)}),p.interceptors.response.use(function(t){var e=t.data,a=t.status;if(e.code,"10001"!=e.code)return 200===a?l.a.resolve(t):_?_(t):l.a.reject(t);location.href="/#/"},function(t){return console.log("err"+t),Object(g.Message)({message:"服务器响应超时，请稍后重试。",type:"error",duration:5e3}),l.a.reject(t)});var f={};["get","post","put","delete"].forEach(function(t){f[t]=function(e,a,s,n){return s?(n=o()({},n||{},{headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}}),p.defaults.transformRequest=[function(t){return m.a.stringify(t)}]):p.defaults.transformRequest=[function(t){return i()(t)}],new l.a(function(s,i){p[t](e,a,n).then(function(t){s(t)}).catch(function(t){i(t)})})}}),f.setToken=function(t){p.defaults.headers.Authorization=t},f.setExceptionHandler=function(t){_=t},e.a=f},d8ns:function(t,e){},dhmY:function(t,e){},e1qu:function(t,e){t.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA8AAAAPCAMAAAAMCGV4AAABTVBMVEUAAAD////////////////4xMnNMUT////////JMkX//////////v/nSFetESf7trzjs7ngcX3TNkjntr3mVmXvTl2pDCPnpq/rmaLkc4D1YW7KRleyLkDxrrf5jpfchZG8SFrgm6r////419v45Ob23+LhP1DcOkz++fr76ev21Njz09ftSVnnRlbKKj2oDCL99vf65ujxys/zvcLstbzsqrLmpKznm6TykJrqjpjei5bXiZTmfIjKUWHcUF/QRlfeRVXDQFHMN0nANknWNUfCKj3FJTm8ITW5GzCwGS20FSv+8fL77e7xztL4zdLuv8TqvcPsusHzsrnlrbXtpa3mn6jllZ/ckpzufIficH3bbnvQbXvxbXnQZnTMYnHjYnDYYnDeW2nmWmnTWmnCVGPoU2LCTl/iTl7aRlfYPE3VNEbEMUS3LUG+IDStESYb6jQLAAAAInRSTlMAAs1YISH56ubmsvn56urm5ubmzc3NzbKysrKyslhYWFghlFJMOgAAANtJREFUCNcdz8Oiw1AUheF9kpTXtvaJWdtur23Xev9h03yztWY/2Ajr9y6u7B8TcHAMIv3QdX3L5UwPnicMI2F0XpbsgzB41xNFUfmjV+ImAZZ+S4VcUgqGM1JBOoLdXH+YfHgdKL+VSjizB+vRgHohqxQFqsrBNXBH4uZbtGTy+bj59OMG33Uo9q9pNT7/GCnVfHAQuuVHmJoIseplqroDJ1pZqAey2WKjUf/kWSAbxffne+Wr1SrfIEMAXMvN8TTdbaZl9HBgO9u2LKstIDIcOMjp4eqC18/O+2bY/iTVHuUMQAAAAABJRU5ErkJggg=="},gcXV:function(t,e){},q88x:function(t,e,a){t.exports=a.p+"static/img/bg.2e32036.png"},tvR6:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.6fd6a49387c57172ec10.js.map